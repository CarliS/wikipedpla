!function(e,t,i){var n={title:$("#firstHeading").text(),categories:[],otherTitles:[],redirects:[],getCategories:function(){$("#mw-normal-catlinks li").each(function(e,t){n.categories.push($(t).text())})},getOtherTitles:function(){$(".dablink").each(function(e,t){test=$(t).text().match('"(.*)" redirects here.'),test&&n.otherTitles.push(test[1])})}},a="e4c036f3302aad8d8c188683967b9619",s="http://api.dp.la/v2/items",r=0,o=0,c={},l=[],p=function(e){return s+"?api_key="+a+"&q="+encodeURIComponent(e)+"&callback=_handleResponse"},d=function(e){$("body").append('<script src="'+p(e)+'"></script>')},u=function(e){c=e;var t=c.docs.length;t>0?f(m):o<n.otherTitles.length?(d(n.otherTitles[o]),o++):r<n.categories.length&&(d(n.categories[r]),r++)},h=function(e,t){var i=parseInt(t,10)||60,n=e.replace(/(\s\/)$/,"");return n.length>i?n.substr(0,i).replace(/\s$/,"")+"&hellip;":n},f=function(e){var t=c.docs,i={};$.each(t,function(e,t){var n=t.sourceResource;i.title=$.isArray(n.title)?n.title[0]:n.title,i.title=h(i.title),i.uri=t.isShownAt,i.type=$.isArray(n.type)?n.type[1]:n.type,i.isImage=w(n),l.push(i),i={}}),"function"==typeof e&&e()},g=function(e){return e.replace("<","&lt;").replace(">","&gt;")},m=function(){var e='<style>.dp-img:after { content: " "; background: url(https://upload.wikimedia.org/wikipedia/commons/a/a3/VisualEditor_-_Icon_-_Picture.svg); width: 12px; height: 12px; display: inline-block; background-size: 12px 12px;} }</style><div id="wikipedpla" class="dablink" style="display:none;"><a href="http://dp.la">DPLA</a> items of possible interest:',t=!1,i=l.length;$.each(l,function(n,a){n+1==i&&(t=!0),t&&(e+=" & "),e+=' <a href="'+g(a.uri)+'"',a.isImage&&(e+=' class="dp-img"'),e+=">"+g(a.title),e+=t?"</a>.":"</a>,"}),e+="</div>",$("#mw-content-text").prepend(e),$("#wikipedpla").show("slow")},w=function(e){var t=e.type;if($.isArray(i)){for(var i in t)if("image"==i.toLowerCase())return!0;return!1}return t&&"image"===t.toLowerCase()?!0:!1},y=function(){var t=$('li[id^="ca-nstab-"]').attr("id");e._handleResponse||(e._handleResponse=u),unsafeWindow&&(unsafeWindow._handleResponse=u),"main"===t.substr(-4)&&(n.getCategories(),n.getOtherTitles(),d(n.title))};y()}(window,document);